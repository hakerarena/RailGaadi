<div class="register-container">
  <div class="register-wrapper">
    <!-- Header Section -->
    <div class="register-header">
      <div class="brand-section">
        <mat-icon class="train-icon">train</mat-icon>
        <div class="brand-text">
          <h1>Join RailGaadi</h1>
          <p>Create your account and start your journey with us</p>
        </div>
      </div>
    </div>

    <!-- Registration Form Card -->
    <mat-card class="register-card">
      <mat-card-header class="card-header">
        <mat-icon mat-card-avatar class="register-avatar">person_add</mat-icon>
        <mat-card-title>Create Account</mat-card-title>
        <mat-card-subtitle
          >Fill in your details to get started</mat-card-subtitle
        >
      </mat-card-header>

      <mat-card-content class="card-content">
        <form
          [formGroup]="registerForm"
          (ngSubmit)="onSubmit()"
          class="register-form"
        >
          <!-- Personal Information Section -->
          <div class="form-section">
            <h3 class="section-title">
              <mat-icon>person</mat-icon>
              Personal Information
            </h3>

            <!-- Name Fields Row -->
            <div class="form-row">
              <mat-form-field
                appearance="outline"
                class="form-field half-width"
              >
                <mat-label>First Name</mat-label>
                <input
                  matInput
                  formControlName="firstName"
                  placeholder="Enter your first name"
                  autocomplete="given-name"
                />
                <mat-icon matSuffix>badge</mat-icon>
                <mat-error *ngIf="getFieldError('firstName')">
                  {{ getFieldError("firstName") }}
                </mat-error>
              </mat-form-field>

              <mat-form-field
                appearance="outline"
                class="form-field half-width"
              >
                <mat-label>Last Name</mat-label>
                <input
                  matInput
                  formControlName="lastName"
                  placeholder="Enter your last name"
                  autocomplete="family-name"
                />
                <mat-icon matSuffix>badge</mat-icon>
                <mat-error *ngIf="getFieldError('lastName')">
                  {{ getFieldError("lastName") }}
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Date of Birth and Gender Row -->
            <div class="form-row">
              <mat-form-field
                appearance="outline"
                class="form-field half-width"
              >
                <mat-label>Date of Birth</mat-label>
                <input
                  matInput
                  [matDatepicker]="dobPicker"
                  formControlName="dateOfBirth"
                  placeholder="Select your date of birth"
                  [max]="maxDate"
                  readonly
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="dobPicker"
                ></mat-datepicker-toggle>
                <mat-datepicker #dobPicker></mat-datepicker>
                <mat-error *ngIf="getFieldError('dateOfBirth')">
                  {{ getFieldError("dateOfBirth") }}
                </mat-error>
              </mat-form-field>

              <mat-form-field
                appearance="outline"
                class="form-field half-width"
              >
                <mat-label>Gender</mat-label>
                <mat-select formControlName="gender">
                  <mat-option
                    *ngFor="let option of genderOptions"
                    [value]="option.value"
                  >
                    {{ option.label }}
                  </mat-option>
                </mat-select>
                <mat-icon matSuffix>wc</mat-icon>
                <mat-error *ngIf="getFieldError('gender')">
                  {{ getFieldError("gender") }}
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Contact Information Section -->
          <div class="form-section">
            <h3 class="section-title">
              <mat-icon>contact_phone</mat-icon>
              Contact Information
            </h3>

            <!-- Email Field -->
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Email Address</mat-label>
              <input
                matInput
                formControlName="email"
                placeholder="Enter your email address"
                autocomplete="email"
                type="email"
              />
              <mat-icon matSuffix>email</mat-icon>
              <mat-error *ngIf="getFieldError('email')">
                {{ getFieldError("email") }}
              </mat-error>
              <mat-hint
                >We'll use this for login and important notifications</mat-hint
              >
            </mat-form-field>

            <!-- Mobile Field -->
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Mobile Number</mat-label>
              <input
                matInput
                formControlName="mobile"
                placeholder="Enter your 10-digit mobile number"
                autocomplete="tel"
                type="tel"
                maxlength="10"
              />
              <mat-icon matSuffix>phone</mat-icon>
              <mat-error *ngIf="getFieldError('mobile')">
                {{ getFieldError("mobile") }}
              </mat-error>
              <mat-hint>Used for OTP verification and booking updates</mat-hint>
            </mat-form-field>
          </div>

          <!-- Security Section -->
          <div class="form-section">
            <h3 class="section-title">
              <mat-icon>security</mat-icon>
              Security
            </h3>

            <!-- Password Field -->
            <mat-form-field
              appearance="outline"
              class="form-field password-field"
            >
              <mat-label>Password</mat-label>
              <input
                matInput
                [type]="hidePassword ? 'password' : 'text'"
                formControlName="password"
                placeholder="Create a strong password"
                autocomplete="new-password"
              />
              <!-- Password Strength Indicator as Suffix -->
              <div matSuffix class="password-strength-inline">
                <span
                  class="strength-indicator-inline"
                  [ngClass]="getPasswordStrength()"
                  [title]="
                    'Password strength: ' +
                    (getPasswordStrength() === 'none'
                      ? 'Enter password'
                      : (getPasswordStrength() | titlecase))
                  "
                >
                  {{
                    getPasswordStrength() === "none"
                      ? "●●●"
                      : getPasswordStrength() === "weak"
                      ? "●○○"
                      : getPasswordStrength() === "medium"
                      ? "●●○"
                      : "●●●"
                  }}
                </span>
              </div>
              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="togglePasswordVisibility('password')"
                [attr.aria-label]="'Toggle password visibility'"
              >
                <mat-icon>{{
                  hidePassword ? "visibility_off" : "visibility"
                }}</mat-icon>
              </button>
              <mat-error *ngIf="getFieldError('password')">
                {{ getFieldError("password") }}
              </mat-error>
            </mat-form-field>

            <!-- Confirm Password Field -->
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Confirm Password</mat-label>
              <input
                matInput
                [type]="hideConfirmPassword ? 'password' : 'text'"
                formControlName="confirmPassword"
                placeholder="Confirm your password"
                autocomplete="new-password"
              />
              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="togglePasswordVisibility('confirmPassword')"
                [attr.aria-label]="'Toggle confirm password visibility'"
              >
                <mat-icon>{{
                  hideConfirmPassword ? "visibility_off" : "visibility"
                }}</mat-icon>
              </button>
              <mat-error *ngIf="getFieldError('confirmPassword')">
                {{ getFieldError("confirmPassword") }}
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Terms and Preferences -->
          <div class="form-section checkbox-section">
            <mat-checkbox
              formControlName="agreeToTerms"
              class="terms-checkbox"
              [color]="'primary'"
            >
              I agree to the
              <a href="#" class="terms-link">Terms & Conditions</a>
              and
              <a href="#" class="terms-link">Privacy Policy</a>
            </mat-checkbox>

            <mat-checkbox
              formControlName="subscribeNewsletter"
              class="newsletter-checkbox"
              [color]="'accent'"
            >
              Subscribe to newsletter for travel updates and offers
            </mat-checkbox>

            <mat-error
              *ngIf="getFieldError('agreeToTerms')"
              class="terms-error"
            >
              {{ getFieldError("agreeToTerms") }}
            </mat-error>
          </div>

          <!-- Register Button -->
          <button
            mat-raised-button
            color="primary"
            type="submit"
            class="register-btn"
            [class.loading]="isLoading"
            [disabled]="!registerForm.valid || isLoading"
          >
            <div *ngIf="isLoading" class="loading-container">
              <div class="custom-loader">
                <div class="train-loader">
                  <mat-icon class="train-icon">train</mat-icon>
                  <div class="track"></div>
                  <div class="progress-dots">
                    <div class="dot"></div>
                    <div class="dot"></div>
                    <div class="dot"></div>
                  </div>
                </div>
              </div>
            </div>
            <span *ngIf="!isLoading" class="button-text">
              <mat-icon>person_add</mat-icon>
              Create Account
            </span>
          </button>

          <!-- Clear Saved Data Button -->
          <button
            type="button"
            mat-stroked-button
            color="warn"
            class="clear-data-btn"
            (click)="clearSavedData()"
            [disabled]="isLoading"
          >
            <mat-icon>clear</mat-icon>
            Clear Saved Data
          </button>
        </form>
      </mat-card-content>

      <mat-divider></mat-divider>

      <!-- Sign In Section -->
      <mat-card-actions class="card-actions">
        <div class="signin-section">
          <span>Already have an account?</span>
          <button
            mat-button
            color="primary"
            (click)="onSignIn()"
            class="signin-btn"
          >
            Sign In
          </button>
        </div>
      </mat-card-actions>
    </mat-card>

    <!-- Benefits Section -->
    <mat-card class="benefits-card">
      <mat-card-content>
        <div class="benefits-info">
          <mat-icon class="benefits-icon">star</mat-icon>
          <div class="benefits-text">
            <h4>Why Join RailGaadi?</h4>
            <ul>
              <li>✅ Quick and easy ticket booking</li>
              <li>✅ Real-time PNR status updates</li>
              <li>✅ Secure payment gateway</li>
              <li>✅ 24/7 customer support</li>
              <li>✅ Exclusive offers and discounts</li>
            </ul>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Security Notice -->
    <div class="security-notice">
      <mat-icon class="security-icon">shield</mat-icon>
      <p>
        Your personal information is secure and encrypted. We follow strict
        privacy policies to protect your data.
      </p>
    </div>
  </div>
</div>
